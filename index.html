<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Holiday Mega Offer - Card Selection & Light Theme</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* Global reset */
    *, *::before, *::after {
      box-sizing: border-box;
    }
    body, html {
      margin: 0; padding: 0;
      height: 100%;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f5f7;
      color: #222;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      background: #ff6e54;
      padding: 15px 20px;
      text-align: center;
      user-select: none;
      box-shadow: 0 3px 8px rgba(255,110,84,0.4);
    }
    header h1 {
      margin: 0;
      font-size: 1.6rem;
      color: #fff;
      font-weight: 700;
      letter-spacing: 1.5px;
      text-shadow: 0 0 8px rgba(255,255,255,0.8);
    }
    header p {
      margin-top: 5px;
      font-size: 0.9rem;
      color: #ffffffcc;
      font-weight: 600;
      letter-spacing: 1px;
    }

    main {
      flex-grow: 1;
      max-width: 480px;
      margin: 30px auto;
      padding: 0 20px 40px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }

    .prize-section {
      width: 100%;
      padding: 25px 20px 40px;
      border-radius: 18px;
      box-shadow: 0 6px 20px rgba(255,110,84,0.4);
      background: linear-gradient(135deg, #ffd6d4, #ffb8b5);
      display: flex;
      flex-direction: column;
      align-items: center;
      user-select: none;
    }

    .prize-section h2 {
      font-size: 1.7rem;
      color: #d23018;
      margin-bottom: 12px;
      font-weight: 700;
      letter-spacing: 0.04em;
      text-align: center;
    }
    .prize-section h3 {
      font-size: 1.2rem;
      color: #a23319;
      font-weight: 600;
      margin-bottom: 20px;
      letter-spacing: 0.05em;
      text-align: center;
    }

    .chances-left {
      font-size: 1.1rem;
      color: #7f3c2f;
      margin-bottom: 24px;
      font-weight: 600;
    }
    .chances-left strong {
      color: #d23018;
      font-weight: 700;
    }

    /* Card selection container */
    .card-selection {
      display: grid;
      gap: 15px;
      margin-bottom: 25px;
      width: 100%;
      max-width: 300px;
      justify-content: center;
      user-select: none;
    }
    /* For toggling grid size on radio change */
    .card-selection.grid-3 {
      grid-template-columns: repeat(3, 1fr);
    }
    .card-selection.grid-4 {
      grid-template-columns: repeat(4, 1fr);
    }

    /* Individual card styling */
    .card {
      background: #ffffffcc;
      border-radius: 10px;
      box-shadow:
        0 4px 10px rgba(222, 72, 34, 0.25);
      padding: 25% 0; /* maintain square aspect ratio */
      cursor: pointer;
      border: 3px solid transparent;
      transition: border-color 0.3s ease, background-color 0.3s ease;
      position: relative;
    }
    .card.selected {
      border-color: #d23018;
      background: #ffb3a9;
      box-shadow:
        0 0 10px 3px rgba(210,48,24,0.8);
    }
    .card:hover {
      background: #ffe6e3;
    }
    .card:after {
      content: attr(data-label);
      font-weight: 600;
      color: #d23018;
      font-size: 1.1rem;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      user-select: none;
    }

    .share-btn {
      background: #d23018;
      color: white;
      font-weight: 700;
      padding: 12px 36px;
      font-size: 1.1rem;
      border-radius: 50px;
      cursor: pointer;
      border: none;
      box-shadow:
        0 4px 14px rgba(210,48,24,0.7),
        inset 0 -3px 6px rgba(255,255,255,0.35);
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      user-select: none;
      width: 100%;
      max-width: 280px;
    }
    .share-btn:disabled {
      background: #b97c72;
      cursor: not-allowed;
      box-shadow: none;
    }
    .share-btn:hover:not(:disabled),
    .share-btn:focus-visible:not(:disabled) {
      background: #e94226;
      box-shadow:
        0 6px 25px rgba(233,66,38,0.85),
        inset 0 -4px 10px rgba(255,255,255,0.5);
      outline: none;
    }
    .share-btn:focus-visible {
      outline: 3px solid #ffb3a9;
      outline-offset: 3px;
    }

    #message {
      color: #982a15;
      font-weight: 700;
      font-size: 1.15rem;
      min-height: 48px;
      text-align: center;
      margin-top: 5px;
      user-select: none;
      min-width: 260px;
    }

    @media (max-width: 480px) {
      main {
        max-width: 95vw;
        padding: 20px 15px 40px;
        min-height: auto;
      }
      .card-selection {
        max-width: 260px;
      }
      .prize-section h2 {
        font-size: 1.4rem;
      }
      .prize-section h3 {
        font-size: 1rem;
        margin-bottom: 15px;
      }
      .share-btn {
        font-size: 1rem;
        padding: 12px 24px;
        max-width: 100%;
      }
      #message {
        min-width: auto;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Holiday Mega Offer</h1>
    <p>Christmas & New Year Special üéÖ‚ú®</p>
  </header>

  <main>
    <section class="prize-section" aria-label="Prize Selection Section">
      <h2>üéÅ Win Exciting Prizes!</h2>
      <h3>Select Your Card Grid Size</h3>
      <p class="chances-left" aria-live="polite">
        Chances left: <strong id="chancesLeft">0</strong>
      </p>
      
      <div role="radiogroup" aria-label="Select card grid size" class="card-selection grid-3" id="cardGrid">
        <div class="card selected" tabindex="0" role="radio" aria-checked="true" data-label="3 √ó 3" data-grid="grid-3"></div>
        <div class="card" tabindex="-1" role="radio" aria-checked="false" data-label="4 √ó 4" data-grid="grid-4"></div>
      </div>

      <button id="shareBtn" class="share-btn" aria-describedby="message">Share Website to Get 3 Chances</button>
      <p id="message" role="status" aria-live="polite" aria-atomic="true"></p>
    </section>
  </main>

  <script>
    (function() {
      const MAX_CHANCES = 3;
      const STORAGE_KEY = "holiday_chances_left";
      const STORAGE_GRID_KEY = "holiday_selected_grid";
      const WIN_MESSAGES = [
        "üéâ You won a free gift!",
        "üéÅ Congrats! You've got a discount!",
        "‚≠ê Lucky you! Bonus points added!",
        "üí• So close! Try again!",
        "üôÅ No luck this time.",
      ];
      
      let chancesLeft = 0;
      let hasShared = false;
      let selectedGridClass = "grid-3";

      const chancesLeftEl = document.getElementById("chancesLeft");
      const shareBtn = document.getElementById("shareBtn");
      const messageEl = document.getElementById("message");
      const cardGrid = document.getElementById("cardGrid");

      // Restore chances and selected grid from localStorage
      try {
        const stored = localStorage.getItem(STORAGE_KEY);
        if (stored !== null) {
          const val = Number(stored);
          if (!isNaN(val) && val >= 0 && val <= MAX_CHANCES) {
            chancesLeft = val;
            if (chancesLeft > 0) hasShared = true;
          }
        }
        const storedGrid = localStorage.getItem(STORAGE_GRID_KEY);
        if(storedGrid === "grid-3" || storedGrid === "grid-4") {
          selectedGridClass = storedGrid;
          updateGridSelectionUI();
          updateGridClassOnSelection();
        }
      } catch(e) {
        chancesLeft = 0;
        hasShared = false;
      }

      updateUI();

      // Card selection as accessible radio buttons
      cardGrid.addEventListener("click", e => {
        if(e.target.classList.contains("card")) {
          setSelectedGrid(e.target.dataset.grid);
        }
      });
      cardGrid.addEventListener("keydown", e => {
        if(e.target.classList.contains("card") && (e.key === "ArrowRight" || e.key === "ArrowLeft")) {
          e.preventDefault();
          const cards = Array.from(cardGrid.querySelectorAll(".card"));
          const currentIndex = cards.indexOf(e.target);
          let nextIndex = (e.key === "ArrowRight") ? currentIndex + 1 : currentIndex -1;
          if(nextIndex < 0) nextIndex = cards.length -1;
          if(nextIndex >= cards.length) nextIndex = 0;
          setSelectedGrid(cards[nextIndex].dataset.grid);
          cards[nextIndex].focus();
        }
      });

      shareBtn.addEventListener("click", async () => {
        if (navigator.share) {
          try {
            await navigator.share({
              title: "Holiday Mega Offer üéÑüéâ",
              text: "Join me and get 3 chances to win exciting prizes! Share & Play üéÅüéÖ",
              url: window.location.href
            });
            if (!hasShared) {
              hasShared = true;
              chancesLeft = MAX_CHANCES;
              localStorage.setItem(STORAGE_KEY, chancesLeft);
              setMessage("Thanks for sharing! You now have 3 chances.");
              updateUI();
            } else {
              alert("You already shared and have 3 chances available.");
            }
          } catch (err) {
            setMessage("Share cancelled or failed. Try sharing to get chances.");
          }
        } else {
          alert("Sharing is not supported on your device/browser. Please share manually.");
        }
      });

      function setSelectedGrid(gridClass) {
        selectedGridClass = gridClass;
        localStorage.setItem(STORAGE_GRID_KEY, selectedGridClass);
        updateGridSelectionUI();
        updateGridClassOnSelection();
        setMessage(`Selected ${gridClass === "grid-3" ? "3√ó3" : "4√ó4"} card grid.`);
      }

      function updateGridSelectionUI() {
        const cards = cardGrid.querySelectorAll(".card");
        cards.forEach(card => {
          const isSelected = (card.dataset.grid === selectedGridClass);
          card.classList.toggle("selected", isSelected);
          card.setAttribute("aria-checked", isSelected ? "true" : "false");
          card.tabIndex = isSelected ? 0 : -1;
        });
      }
      function updateGridClassOnSelection() {
        cardGrid.classList.remove("grid-3", "grid-4");
        cardGrid.classList.add(selectedGridClass);
      }

      function updateUI() {
        chancesLeftEl.textContent = chancesLeft;
        shareBtn.disabled = (chancesLeft === MAX_CHANCES);
      }
      function setMessage(text) {
        messageEl.textContent = text;
      }

    })();
  </script>
</body>
</html>
